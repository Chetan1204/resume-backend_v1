<div style="width: 100%;height: 100%;padding: 15px;">
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<div>
		<h3>All Models</h3>
		<p>Create, edit, and manage the models of your site.</p>
	</div>
	<style>
		tbody tr:nth-child(odd){
			background-color: aliceblue;
		}
		tbody tr:nth-child(even){
			background-color: #f5f5f5;
		}
	</style>
	<table width="100%" cellspacing="0" cellpadding="0">
		<thead style="border-bottom: 2px solid #d8d8d8;">
		  <tr>
			<th>
				<div style="display: flex; align-items: center; justify-content: start;">
					<h3 style="font-weight: 600;font-size: 12px;text-transform: uppercase;margin: 0px;">Model Name</h3>  
				</div>
			</th>
			<th>
				<div style="display: flex; align-items: center; justify-content: start;">
					<h3 style="font-weight: 600;font-size: 12px;text-transform: uppercase;margin: 0px;">Model Actions</h3>  
				</div>
			</th>
			<th>
				<div style="display: flex; align-items: center; justify-content: end;padding-bottom: 5px;">
					<button class="button-main button-main-md" onclick="handleAddNewModel()">Add New Model</button>
				</div>
			</th>
			
		  </tr>
		</thead>
		<tbody>
			<% allModels.forEach(model => { %>
				<tr style="border-bottom: 1px solid rgba(0,0,0,0.25);">
					<td style="padding: 5px 10px;">
						<span style="font-weight: 600;font-size: 13px;"><%= model.modelName %></span>
					</td>
					<td style="padding: 5px 10px;" colspan="2">
						<div style="display: flex;width: 100%;align-items: center;justify-content: flex-start;gap: 10px;">
							<span style="display: inline-block;">
								<span style="cursor: pointer;font-size: 12px;padding: 0px; font-weight: 600;" onclick="editModel('<%= model.modelName %>')"><i class="fa-solid fa-pen"></i></span>
							</span>
							<span style="display: inline-block;">
								<span style="cursor: pointer;font-size: 12px;padding: 0px; font-weight: 600;" onclick="deleteModel('<%= model.modelName %>')"><i class="fa-solid fa-trash-can"></i></span>
							</span>
							<label for="<%= model.modelSlug %>" style="font-size: 13px;font-weight: 600;padding-top: 4px;"><i class="fa-solid fa-thumbtack"></i></label>
							<input type="checkbox" <%= model?.pin ? 'checked':"" %> id="<%= model.modelSlug %>" onchange="handlePinning(this, '<%= model.modelName %>', '<%= model._id %>')">
						</div>
					</td>
				</tr>
	
			<% }) %>
		</tbody>
	  </table>

</div>




<script>

function handlePinning(element, modelName, modelId) {
	
	fetch("/api/v1/manage/pin-custom-field", {
		method:"POST",
		headers:{
			"Content-Type":"application/json"
		},
		body:JSON.stringify({modelName, modelId, pin:element.checked})
	}).then(res => res.json).then(data => { window.location.reload(); }).catch(err => console.log(err))
}

function handleAddNewModel() {
    window.location.href = "/api/v1/manage/add-new-model"
} 
function editModel(modelname){
    window.location.href = `/api/v1/manage/rendermodel?modelname=${encodeURIComponent(modelname)}`

}
function deleteModel(modelName){
	
	Swal.fire({
			title: 'Do you want to delete this post?',
			showDenyButton: true,
			showCancelButton: false,
			confirmButtonText: 'Delete',
			denyButtonText: 'Cancel',
			customClass: {
				actions: 'my-actions',
				cancelButton: 'order-1 right-gap',
				confirmButton: 'order-2',
			},
			}).then((result) => {
				if (result.isConfirmed) {
					fetch("/api/v1/manage/delete-model", {
						method:"POST",
						headers:{
							"Content-Type":"application/json"
						},
						body:JSON.stringify({modelName})
					})
					.then(res => res.json())
					.then(data => window.location.reload())
				} else if (result.isDenied) {
					Swal.fire('Changes are not saved', '', 'info')
				}
			})
}

</script>