<div style="width: 100%;height: 100%;padding: 15px;">
	<div>
		<h3>Pages</h3>
		<p>Create, edit, and manage the pages on your site.</p>
	</div>
	<style>
		tbody tr:nth-child(odd){
			background-color: aliceblue;
		}
		tbody tr:nth-child(even){
			background-color: #f5f5f5;
		}
	</style>
	<table cellspacing="0" cellpadding="0" width="100%">
		<thead style="border-bottom: 2px solid #d8d8d8;">
			<tr>
				<th>
					<div style="display: flex; align-items: center; justify-content: start;">
						<h3 style="font-weight: 600;font-size: 12px;text-transform: uppercase;margin: 0px;">Page Name</h3>
					</div>
				</th>
				<th>
					<div style="display: flex; align-items: center; justify-content: start;">
						<h3 style="font-weight: 600;font-size: 12px;text-transform: uppercase;margin: 0px;">Page Author</h3>
					</div>
				</th>
				<th>
					<div style="display: flex; align-items: center; justify-content: start;">
						<h3 style="font-weight: 600;font-size: 12px;text-transform: uppercase;margin: 0px;">Page Actions</h3>
					</div>
				</th>
				<th>
					<div style="display: flex; align-items: center; justify-content: end;padding-bottom: 5px;">
						<span
							class="button-main button-main-md"
							id="openModalBtn">Add New Page</span>
					</div>
				</th>
			</tr>
		</thead>
		<tbody>
			<% if(allPages.length > 0 ){ allPages.forEach(page=> { %>
				<tr style="border-bottom: 1px solid rgba(0,0,0,0.25);">
					<td style="padding: 5px 10px;">
						<span style="font-weight: 600;font-size: 13px;font-weight: 600;">	
							<%= page.name %>
						</span>
					</td>
					<td style="padding: 5px 10px;">
						<div style="display: flex;align-items: center;justify-content: flex-start;">
							<p style="margin-bottom: 0px;font-size: 13px;font-weight: 600;">
								<%= page.author %>
							</p>
						</div>
					</td>
					<td colspan="2" style="padding: 5px 10px;">
						<div style="display: flex;width: 100%;align-items: center;justify-content: flex-start;gap: 10px;">
							<span style="display: inline-block;">
								<span style="cursor: pointer;font-size: 12px;padding: 0px; font-weight: 600;" onclick="editPage('<%= page.name %>')"><i class="fa-solid fa-pen"></i></span>
							</span>
							<span style="display: inline-block;">
								<span style="cursor: pointer;font-size: 12px;padding: 0px; font-weight: 600;" onclick="deletePage('<%= page.name %>')"><i class="fa-solid fa-trash-can"></i></span>
							</span>
						</div>
					</td>
				</tr>
			<% })} else { %>
				<tr>
					<td colspan="4">
						<div style="background-color: #fff;border: 1px solid rgba(0,0,0,0.25);border-radius: 6px;width: 100%;height: 100px;display: flex; align-items: center;justify-content: center;">
							<h4 style="color: #484848;">No Pages Created Yet</h4 style="color: #484848;">

						</div>
					</td>
				</tr>
			<% } %>
		</tbody>
	</table>
	<!-- modal  start-->
	<div id="myModal" class="modal">
		<div class="modal-content">
			<span class="close">&times;</span>
			<div style="padding: 20px 0;">
				<form action="/create-page" method="post">
					<div>
						<div>
							<label class="pb-2" for="page-heading">Page Name</label>
							<input class="form-control" style="width: 100%;display: block;padding:5px;" type="text" name="pageHeading" autofocus>
						</div>
						<div>
							<label class="pb-2" for="author">Author</label>
							<input class="form-control" style="width: 100%;display: block;padding:5px;" type="text" name="author">
						</div>
						<button class="mt-4 button-main button-main-md" type="submit">Create Page</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>



<!-- modal end -->
<script src="https://cdn.jsdelivr.net/npm/notyf@3/notyf.min.js"></script>
<script>

	const notyf = new Notyf({
		types: [
			{
				type: 'info',
				background: '#900C3F',
				icon: false,
				dismissible:true
			}
		]
	});
	const message = "<%= message %>";
	if(message){
		notyf.open({
			type:"info",
			message:message
		})
	}
	

	const modal = document.getElementById('myModal');
	const openModalBtn = document.getElementById('openModalBtn');
	const closeBtn = document.getElementsByClassName('close')[0];

	openModalBtn.onclick = function () {
		modal.style.display = 'block';
	};

	closeBtn.onclick = function () {
		modal.style.display = 'none';
	};

	window.onclick = function (event) {
		if (event.target === modal) {
			modal.style.display = 'none';
		}
	};

	window.addEventListener("DOMContentLoaded", ()=>{
		const thisUrl = new URL(window.location.href);
		const param1 = thisUrl.searchParams.get("addnewmodal");
		if(param1 === "true"){
			modal.style.display = "block"
		}
	})

	function editPage(pageName) {
		// Redirect to the edit page route (replace with your actual route)
		window.location.href = `/page/${pageName}`;
	}

	function deletePage(pageName) {
		// Show a confirmation dialog before deleting
		const isConfirmed = confirm(`Are you sure you want to delete the page "${pageName}"?`);

		if (isConfirmed) {
			// Make an AJAX request to delete the page (replace with your actual route)
			fetch(`/delete-page/${pageName}`, {
				method: 'DELETE',
			})
				.then(response => {
					if (response.ok) {
						window.location.reload();
					} else {
						console.error('Failed to delete page:', response.statusText);
					}
				})
				.catch(error => {
					console.error('Error deleting page:', error);
				});
		}
	}
</script>